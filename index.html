<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Sahabat Kopag - Simulasi Pendinginan Kopi</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#6f4e37">
<link rel="icon" href="assets/icon-192.png" type="image/png">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f4f6f9;margin:0;padding:20px;color:#222}
.container{max-width:1000px;margin:0 auto}
.header{text-align:center;color:#6f4e37}
.hero{display:flex;justify-content:center;margin:20px 0}
.hero video{max-width:90%;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.2)}
.card{background:#fff;padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);margin-bottom:20px}
.row{display:flex;gap:20px;flex-wrap:wrap}
.col{flex:1;min-width:280px}
label{font-weight:bold;display:block;margin-top:8px}
input,button{width:100%;padding:10px;margin-top:6px;border:1px solid #ccc;border-radius:6px}
button{background:#6f4e37;color:white;border:none;cursor:pointer}
#chart{width:100%;height:240px;background:#fff;border-radius:6px;box-shadow:inset 0 0 0 1px #eee}
.table-fixed{max-height:200px;overflow:auto}
code{background:#f1f1f1;padding:6px;border-radius:4px;display:block}
.math{background:#f9fbff;padding:10px;border-radius:6px;border:1px solid #e6f0fb}
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<div class="container">
  <h1 class="header">Sahabat Kopag - Simulasi Penurunan Suhu (Metode Iteratif Euler)</h1>
  <div class="hero">
    <video autoplay muted loop playsinline>
      <source src="assets/ornamen.mp4" type="video/mp4">
    </video>
  </div>

  <div class="card">
    <h2>Rumus</h2>
    <div class="math">
      <p>Hukum Pendinginan Newton: $$\\frac{dT}{dt} = -k(T - T_a)$$</p>
      <p>Metode Euler: $$T_{n+1} = T_n + \\Delta t(-k(T_n - T_a))$$</p>
    </div>
  </div>

  <div class="card row">
    <div class="col">
      <label>Suhu awal T0 (°C)</label><input id="t0" type="number" value="90">
      <label>Suhu lingkungan Ta (°C)</label><input id="ta" type="number" value="27">
      <label>k (per menit)</label><input id="k" type="number" step="0.001" value="0.03">
      <label>Δt (menit)</label><input id="dt" type="number" step="0.1" value="0.5">
      <label>Durasi (menit)</label><input id="dur" type="number" value="60">
      <button id="run">Jalankan Simulasi</button>
    </div>
    <div class="col">
      <h3>Hasil</h3>
      <div id="chart"></div>
      <div class="table-fixed"><table id="resultTable" style="width:100%"></table></div>
      <p id="summary"></p>
    </div>
  </div>
</div>

<script>
function runSimulation(T0, Ta, k, dt, dur) {
  const steps=Math.ceil(dur/dt); let T=parseFloat(T0);
  const times=[0], temps=[T];
  for(let i=0;i<steps;i++){const dTdt=-k*(T-Ta);T+=dt*dTdt;times.push(((i+1)*dt).toFixed(3));temps.push(parseFloat(T.toFixed(4)));}
  return {times,temps};
}
function drawChart(times,temps){
  const chart=document.getElementById('chart');chart.innerHTML='';
  const width=chart.clientWidth||800,height=240,pad=40;
  const maxT=Math.max(...temps),minT=Math.min(...temps);
  const points=temps.map((t,i)=>{const x=pad+(i/(temps.length-1))*(width-pad*2);const y=pad+(1-(t-minT)/(maxT-minT||1))*(height-pad*2);return x+','+y;}).join(' ');
  const svgNS='http://www.w3.org/2000/svg',svg=document.createElementNS(svgNS,'svg');
  svg.setAttribute('width','100%');svg.setAttribute('height',height);svg.setAttribute('viewBox','0 0 '+width+' '+height);
  const poly=document.createElementNS(svgNS,'polyline');poly.setAttribute('points',points);poly.setAttribute('fill','none');poly.setAttribute('stroke','#e74c3c');poly.setAttribute('stroke-width','3');svg.appendChild(poly);chart.appendChild(svg);
}
document.getElementById('run').addEventListener('click',()=>{
  const T0=parseFloat(document.getElementById('t0').value),Ta=parseFloat(document.getElementById('ta').value),k=parseFloat(document.getElementById('k').value),dt=parseFloat(document.getElementById('dt').value),dur=parseFloat(document.getElementById('dur').value);
  if([T0,Ta,k,dt,dur].some(isNaN))return alert('Input salah');
  const res=runSimulation(T0,Ta,k,dt,dur);drawChart(res.times,res.temps);
  const table=document.getElementById('resultTable');table.innerHTML='<tr><th>t (m)</th><th>T (°C)</th></tr>';res.times.forEach((t,i)=>{table.innerHTML+='<tr><td>'+t+'</td><td>'+res.temps[i]+'</td></tr>';});
  const idx=res.temps.findIndex(v=>v<=65);document.getElementById('summary').innerHTML=idx>=0?'☕ Suhu 65°C tercapai pada '+res.times[idx]+' menit':'Tidak tercapai 65°C';
});
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}
</script>
</body>
</html>
