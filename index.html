
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulasi Suhu Kopi dengan Grafik</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- Halaman input -->
<div id="page1" class="page">
  <h1>Simulasi Suhu Kopi</h1>
  <input type="number" id="initialTemp" placeholder="Masukkan suhu awal kopi (Â°C)">
  <input type="number" id="targetTemp" placeholder="Masukkan suhu target kopi (Â°C)">
  <button id="startBtn">Mulai Simulasi</button>
</div>

<!-- Halaman video + hasil -->
<div id="page2" class="page hidden">
  <h1>Video & Hasil Suhu Kopi</h1>
  <video id="myVideo" autoplay muted loop playsinline>
    <source src="video.mp4" type="video/mp4">
    Your browser does not support HTML5 video.
  </video>
  <div id="result"></div>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div id="status" class="status"></div>

  <!-- Grafik suhu -->
  <canvas id="temperatureChart" width="400" height="200"></canvas>

  <!-- Tabel data suhu -->
  <table id="dataTable">
    <thead>
      <tr><th>Detik</th><th>Suhu (Â°C)</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
const page1 = document.getElementById('page1');
const page2 = document.getElementById('page2');
const startBtn = document.getElementById('startBtn');
const initialInput = document.getElementById('initialTemp');
const targetInput = document.getElementById('targetTemp');
const resultDiv = document.getElementById('result');
const progressBar = document.getElementById('progressBar');
const statusDiv = document.getElementById('status');
const video = document.getElementById('myVideo');
const chartCanvas = document.getElementById('temperatureChart');
const dataTableBody = document.querySelector('#dataTable tbody');

let tempChart;

startBtn.addEventListener('click', () => {
  let initialTemp = parseFloat(initialInput.value);
  let targetTemp = parseFloat(targetInput.value);

  if(isNaN(initialTemp)) initialTemp = 25;
  if(isNaN(targetTemp)) targetTemp = 70;

  page1.classList.add('hidden');
  page2.classList.remove('hidden');

  // Reset chart & table
  dataTableBody.innerHTML = '';
  if(tempChart) tempChart.destroy();

  tempChart = new Chart(chartCanvas, {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label: 'Suhu Kopi (Â°C)',
        data: [],
        borderColor: 'rgba(255,99,132,1)',
        backgroundColor: 'rgba(255,99,132,0.2)',
        fill: true,
      }]
    },
    options: {
      animation: false,
      scales: {
        x: { title: { display: true, text: 'Waktu (detik)' } },
        y: { title: { display: true, text: 'Suhu (Â°C)' }, beginAtZero: false }
      }
    }
  });

  simulateCoffeeTemperature(targetTemp, initialTemp);
});

function simulateCoffeeTemperature(targetTemp, initialTemp) {
  let T = initialTemp;
  const k = 0.1;
  const dt = 1;
  let time = 0;

  resultDiv.innerHTML = `<p>Target suhu kopi: ${targetTemp}Â°C</p>
                         <p>Suhu awal: ${T}Â°C</p>`;
  progressBar.style.width = '0%';
  statusDiv.textContent = '';

  function step() {
    if(T < targetTemp) {
      T += k * (targetTemp - T) * dt;
      time += dt;

      const percent = Math.min(((T - initialTemp)/(targetTemp - initialTemp))*100, 100);
      progressBar.style.width = percent + '%';

      // Klasifikasi suhu & visual
      if(T < 45) {
        statusDiv.textContent = "Terlalu Dingin â„ï¸";
        statusDiv.style.color = '#1E90FF';
        progressBar.style.backgroundColor = '#1E90FF';
        document.body.style.backgroundColor = '#87CEFA';
      } else if(T >= 45 && T <= 65) {
        statusDiv.textContent = "Suhu Pas untuk Dinikmati â˜•";
        statusDiv.style.color = '#4CAF50';
        progressBar.style.backgroundColor = '#4CAF50';
        document.body.style.backgroundColor = '#32CD32';
      } else {
        statusDiv.textContent = "Terlalu Panas ðŸ”¥";
        statusDiv.style.color = '#FF4500';
        progressBar.style.backgroundColor = '#FF4500';
        document.body.style.backgroundColor = '#FF6347';
      }

      resultDiv.innerHTML = `<p>Target suhu kopi: ${targetTemp}Â°C</p>
                             <p>Suhu saat ini: ${T.toFixed(2)}Â°C</p>`;

      // Update chart
      tempChart.data.labels.push(time);
      tempChart.data.datasets[0].data.push(T.toFixed(2));
      tempChart.update();

      // Update table
      const row = document.createElement('tr');
      row.innerHTML = `<td>${time}</td><td>${T.toFixed(2)}</td>`;
      dataTableBody.appendChild(row);

      requestAnimationFrame(step);
    } else {
      resultDiv.innerHTML += `<p>Suhu kopi tercapai dalam ${time} detik.</p>`;
      progressBar.style.width = '100%';
    }
  }

  step();
}

// Video autoplay handling
video.addEventListener('loadeddata', () => {
  video.play().catch(err => console.error('Video autoplay error:', err));
});
video.addEventListener('error', (e) => {
  console.error('Video load error:', e);
  resultDiv.innerHTML += `<p style="color:red">Video gagal dimuat.</p>`;
});
</script>

</body>
</html>
